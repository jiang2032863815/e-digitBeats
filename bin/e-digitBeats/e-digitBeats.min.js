var __reflect=this&&this.__reflect||function(t,e,n){t.__class__=e,n?n.push(e):n=[e],t.__types__=t.__types__?n.concat(t.__types__):n},__extends=this&&this.__extends||function(t,e){function n(){this.constructor=t}for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i]);n.prototype=e.prototype,t.prototype=new n},__awaiter=this&&this.__awaiter||function(t,e,n,i){return new(n||(n=Promise))(function(o,r){function a(t){try{_(i.next(t))}catch(e){r(e)}}function s(t){try{_(i["throw"](t))}catch(e){r(e)}}function _(t){t.done?o(t.value):new n(function(e){e(t.value)}).then(a,s)}_((i=i.apply(t,e||[])).next())})},__generator=this&&this.__generator||function(t,e){function n(t){return function(e){return i([t,e])}}function i(n){if(o)throw new TypeError("Generator is already executing.");for(;_;)try{if(o=1,r&&(a=r[2&n[0]?"return":n[0]?"throw":"next"])&&!(a=a.call(r,n[1])).done)return a;switch(r=0,a&&(n=[0,a.value]),n[0]){case 0:case 1:a=n;break;case 4:return _.label++,{value:n[1],done:!1};case 5:_.label++,r=n[1],n=[0];continue;case 7:n=_.ops.pop(),_.trys.pop();continue;default:if(a=_.trys,!(a=a.length>0&&a[a.length-1])&&(6===n[0]||2===n[0])){_=0;continue}if(3===n[0]&&(!a||n[1]>a[0]&&n[1]<a[3])){_.label=n[1];break}if(6===n[0]&&_.label<a[1]){_.label=a[1],a=n;break}if(a&&_.label<a[2]){_.label=a[2],_.ops.push(n);break}a[2]&&_.ops.pop(),_.trys.pop();continue}n=e.call(t,_)}catch(i){n=[6,i],r=0}finally{o=a=0}if(5&n[0])throw n[1];return{value:n[0]?n[1]:void 0,done:!0}}var o,r,a,s,_={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]};return s={next:n(0),"throw":n(1),"return":n(2)},"function"==typeof Symbol&&(s[Symbol.iterator]=function(){return this}),s},digitBeats;!function(t){t.nil=null}(digitBeats||(digitBeats={}));var digitBeats;!function(t){var e=function(){function e(){this.__pre=t.nil,this.__nxt=t.nil,this.val=t.nil}return e.prototype.nxt=function(){return this.__nxt},e.prototype.pre=function(){return this.__pre},e.prototype.setNxt=function(t){this.__nxt=t},e.prototype.setPre=function(t){this.__pre=t},e.prototype.setVal=function(t){this.val=t},e}();t.Node=e,__reflect(e.prototype,"digitBeats.Node");var n=function(){function n(){this.__head=t.nil,this.__tail=t.nil}return n.prototype.pushBack=function(n){var i=new e;return i.setVal(n),this.__head==t.nil?this.__head=this.__tail=i:(this.__tail.setNxt(i),i.setPre(this.__tail),this.__tail=i),i},n.prototype.pushFront=function(n){var i=new e;return i.setVal(n),this.__head==t.nil?this.__head=this.__tail=i:(this.__head.setPre(i),i.setNxt(this.__head),this.__head=i),i},n.prototype.removeNode=function(e){if(e!=t.nil)if(this.__head==e)this.__head=this.__head.nxt(),this.__head!=t.nil&&this.__head.setPre(t.nil);else if(this.__tail==e)this.__tail=this.__tail.pre(),this.__tail!=t.nil&&this.__tail.setNxt(t.nil);else{if(t.__isDebugMode&&(e.pre()==t.nil||e.nxt()==t.nil))throw new Error("双向链表节点删除错误");e.pre().setNxt(e.nxt()),e.nxt().setPre(e.pre())}},n.prototype.front=function(){return this.__head},n.prototype.back=function(){return this.__tail},n.prototype.isEmpty=function(){return this.__head==t.nil},n.prototype.moveLinkToFront=function(e){e!=t.nil&&e!=this.__head&&this.__head!=this.__tail&&(e.pre().setNxt(t.nil),this.__tail.setNxt(this.__head),this.__head.setPre(this.__tail),this.__head=e,this.__tail=e.pre(),e.setPre(t.nil))},n}();t.LinkList=n,__reflect(n.prototype,"digitBeats.LinkList")}(digitBeats||(digitBeats={}));var digitBeats;!function(t){var e=function(){function e(){this.__frameElements=new t.LinkList,this.__elementMap={},this.tickThroughFlag=!0,egret.startTick(this.__onTick,this)}return e.prototype.addToFrameSystem=function(t){var e=this.__frameElements.pushBack(t);return this.__elementMap[t.__ruixueCode]=e,e},e.prototype.removeFromFrameSystem=function(t){var e=this.__elementMap[t.__ruixueCode];e&&(delete this.__elementMap[t.__ruixueCode],this.__frameElements.removeNode(e))},e.prototype.__onTick=function(){if(this.tickThroughFlag)for(var e=this.__frameElements.front();e!=t.nil;e=e.nxt())e.val.onUpdate();else for(var e=this.__frameElements.back();e!=t.nil;e=e.pre())e.val.onUpdate();return this.tickThroughFlag=!this.tickThroughFlag,!1},e}();__reflect(e.prototype,"FrameManager");var n=0,i=new e,o=function(e){function o(){var i=e.call(this)||this;return i.__isInFrameManager=!1,i.parentInterface=new t.InterfaceManager,i.__ruixueCode=++n,i.onStart(),i.__onNew(),i}return __extends(o,e),o.createComponent=function(e){this.__cycleManagers[e.ConstructorName]||(this.__cycleManagers[e.ConstructorName]=new t.CycleManager(e));var n=this.__cycleManagers[e.ConstructorName].create();return n},o.releaseComponent=function(e,n){this.__cycleManagers[e.ConstructorName]||(this.__cycleManagers[e.ConstructorName]=new t.CycleManager(e)),n.parentInterface.clearInterfaces(),n.removeEventListener(egret.Event.ADDED_TO_STAGE,n.__onAddToStage,n),n.removeEventListener(egret.Event.REMOVED_FROM_STAGE,n.__onRemovedFromStage,n),n.__isInFrameManager&&(i.removeFromFrameSystem(n),n.__isInFrameManager=!1),this.__cycleManagers[e.ConstructorName].release(n)},o.prototype.__onAddToStage=function(){this.onAddToStage(),i.addToFrameSystem(this),this.__isInFrameManager=!0},o.prototype.__onRemovedFromStage=function(){i.removeFromFrameSystem(this),this.__isInFrameManager=!1,this.onRemovedFromStage()},o.prototype.__onNew=function(){this.addEventListener(egret.Event.ADDED_TO_STAGE,this.__onAddToStage,this),this.addEventListener(egret.Event.REMOVED_FROM_STAGE,this.__onRemovedFromStage,this)},o.prototype.onStart=function(){},o.prototype.onEnd=function(){},o.prototype.onUpdate=function(){},o.prototype.onAddToStage=function(){},o.prototype.onRemovedFromStage=function(){},o.__cycleManagers={},o}(eui.Component);t.Component=o,__reflect(o.prototype,"digitBeats.Component",["digitBeats.ICycleObject"])}(digitBeats||(digitBeats={}));var digitBeats;!function(t){var e=function(){function t(t){this.constructorName=t,this.source=[]}return t.prototype.create=function(){if(this.source.length>0){var t=this.source.pop();return t.onStart(),t.__onNew(),t}var t=new this.constructorName;return t},t.prototype.release=function(t){t.onEnd(),this.source.push(t)},t}();t.CycleManager=e,__reflect(e.prototype,"digitBeats.CycleManager")}(digitBeats||(digitBeats={}));var digitBeats;!function(t){var e=function(){function e(){this.__interfaces={}}return e.prototype.attachInterface=function(t,e,n){this.__interfaces[t]={callFunc:e,thisObject:n}},e.prototype.call=function(e){for(var n=[],i=1;i<arguments.length;i++)n[i-1]=arguments[i];if(t.__isDebugMode&&!this.__interfaces[e])throw new Error("未注册该接口");var o=this.__interfaces[e];return(r=o.callFunc).call.apply(r,[o.thisObject].concat(n));var r},e.prototype.clearInterfaces=function(){this.__interfaces={}},e}();t.InterfaceManager=e,__reflect(e.prototype,"digitBeats.InterfaceManager")}(digitBeats||(digitBeats={}));var digitBeats;!function(t){function e(e){t.__isDebugMode=e}t.__isDebugMode=!0,t.modeDebug=e}(digitBeats||(digitBeats={}));var digitBeats;!function(t){var e=function(){function e(e){this.mainContainer=e,this.nowScene=t.nil,this.scenePool={},this.onResourceGroupLoadedBinded=this.onResourceGroupLoaded.bind(this),e.removeChildren()}return e.prototype.attachScene=function(e,n,i,o){void 0===o&&(o=t.nil),this.scenePool[e]={scene:n,loadingScene:o,groupName:i},n.parentInterface.attachInterface(0,this.scene_interface_change_scene_with_init_data,this)},e.prototype.scene_interface_change_scene_with_init_data=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];this.changeSceneWithInitData.apply(this,[t].concat(e))},e.prototype.onResourceGroupLoaded=function(){++this.__now_cnt>=this.__now_tot&&(this.scenePool[this.__now_change_scene_id].loadingScene!=t.nil&&this.mainContainer.removeChild(this.scenePool[this.__now_change_scene_id].loadingScene),(e=this.nowScene).initWithData.apply(e,this.__now_change_scene_data),this.mainContainer.addChild(this.nowScene));var e},e.prototype.changeSceneWithInitData=function(e){for(var n=[],i=1;i<arguments.length;i++)n[i-1]=arguments[i];if(!this.scenePool[e])throw new Error("未找到该场景！！！");this.nowScene!=t.nil&&this.mainContainer.removeChild(this.nowScene),this.__now_change_scene_id=e;var o=this.scenePool[e].groupName;this.__now_tot=0;for(var r=0;r<o.length;r++)RES.isGroupLoaded(o[r])||this.__now_tot++;if(this.nowScene=this.scenePool[e].scene,0==this.__now_tot)(h=this.nowScene).initWithData.apply(h,n),this.mainContainer.addChild(this.nowScene);else{if(this.scenePool[e].loadingScene!=t.nil){this.mainContainer.addChild(this.scenePool[e].loadingScene);for(var a=[],r=0;r<o.length;r++)RES.isGroupLoaded(o[r])||a.push(RES.getGroupByName(o[r]));this.scenePool[e].loadingScene.onBeforeLoad(a)}this.__now_cnt=0;for(var s=0,_=o;s<_.length;s++){var c=_[s];RES.isGroupLoaded(c)||(this.scenePool[e].loadingScene!=t.nil?RES.loadGroup(c,0,this.scenePool[e].loadingScene).then(this.onResourceGroupLoadedBinded):RES.loadGroup(c,0).then(this.onResourceGroupLoadedBinded))}}var h},e}();t.SceneManager=e,__reflect(e.prototype,"digitBeats.SceneManager")}(digitBeats||(digitBeats={}));var digitBeats;!function(t){var e=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.onBeforeLoad=function(t){},e.prototype.onProgress=function(t,e){},e}(t.Component);t.LoadingScene=e,__reflect(e.prototype,"digitBeats.LoadingScene")}(digitBeats||(digitBeats={}));var digitBeats;!function(t){var e=function(e){function n(n){void 0===n&&(n=t.nil);var i=e.call(this)||this;return i.globalHandle=n,i}return __extends(n,e),n.prototype.initWithData=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e]},n.prototype.loadBeforeInStage=function(){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(t){return[2]})})},n.prototype.changeSceneWithInitData=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];(i=this.parentInterface).call.apply(i,[0,t].concat(e));var i},n}(t.Component);t.Scene=e,__reflect(e.prototype,"digitBeats.Scene")}(digitBeats||(digitBeats={}));var digitBeats;!function(t){function e(n){if(void 0==n||n==t.nil)return t.nil;var i;if(n instanceof Array)i=[];else{if(!(n instanceof Object))return i;i=new Object}for(var o in n)n[o]instanceof Object?i[o]=e(n[o]):i[o]=n[o];return i}t.cloneObject=e}(digitBeats||(digitBeats={}));